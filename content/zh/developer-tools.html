<!doctype html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content><meta name="author" content><link rel="icon" href="/favicon.ico"><base href="https://kyuubi.apache.org/"><title>Apache Kyuubi - Multi-tenant Thrift JDBC/ODBC server</title>
<link rel="stylesheet" href="/css/vendor/bootstrap.min.css"><link rel="stylesheet" href="/css/vendor/bootstrap-theme.min.css"><link rel="stylesheet" href="/css/vendor/semantic.min.css"><link rel="stylesheet" href="/css/homePage.css"><link rel="stylesheet" href="/css/kyuubi.css"></head><body><div id="nav_mask" class='nav_mask' style="display:none"></div><nav id="header" class="header"><a href="/zh"><img class="navbar_logo" src="/kyuubi_logo_hd.png"></a><ul class="navContainer"><li class="navItem"><a class="navLink" href="zh/releases.html">下载</a></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">文档
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/master/">master (dev-only)</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.11.0/">1.11.0
(latest)</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.10.3/">1.10.3</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.9.4/">1.9.4</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.8.3/">1.8.3</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.7.4/">1.7.4</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.6.1-incubating/">1.6.1-incubating</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.5.2-incubating/">1.5.2-incubating</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.4.1-incubating/">1.4.1-incubating</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.3.1-incubating/">1.3.1-incubating</a></li></ul></div></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">社区
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="https://www.apache.org/foundation/policies/conduct">行为守则</a></li><li><a class="childNavLink" href="/zh/become_committer.html">成为 Committer</a></li><li><a class="childNavLink" href="/zh/become_pmc_member.html">成为 PMC 成员</a></li><li><a class="childNavLink" href="/zh/new_pmc_member_process.html">新晋 PMC 流程</a></li><li><a class="childNavLink" href="/zh/project_history.html">最新消息</a></li><li><a class="childNavLink" href="/zh/mailing_lists.html">加入邮件列表</a></li><li><a class="childNavLink" href="/zh/new_committer_process.html">新晋 Committer 流程</a></li></ul></div></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">发展
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="/zh/issue_tracking.html">问题追踪</a></li><li><a class="childNavLink" href="/zh/pull_request.html">提交PR指南</a></li><li><a class="childNavLink" href="/zh/improvement-proposals.html">改进提案 (KPIP)</a></li><li><a class="childNavLink" href="/zh/developer-tools.html">有用的开发者工具</a></li><li><a class="childNavLink" href="/zh/version_control.html">版本控制</a></li></ul></div></li><li class="navItem"><a class="navLink" href="zh/powered_by.html">用户</a></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">Github
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="https://github.com/apache/kyuubi">kyuubi</a></li><li><a class="childNavLink" href="https://github.com/apache/kyuubi-client">kyuubi-client</a></li><li><a class="childNavLink" href="https://github.com/apache/kyuubi-docker">kyuubi-docker</a></li><li><a class="childNavLink" href="https://github.com/apache/kyuubi-website">kyuubi-website</a></li></ul></div></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">ASF
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="https://www.apache.org/licenses/">License</a></li><li><a class="childNavLink" href="https://www.apache.org/">基金会</a></li><li><a class="childNavLink" href="https://www.apache.org/security/">安全</a></li><li><a class="childNavLink" href="https://www.apache.org/foundation/thanks.html">感谢</a></li><li><a class="childNavLink" href="https://www.apache.org/events/current-event">活动</a></li><li><a class="childNavLink" href="https://www.apache.org/foundation/sponsorship.html">赞助</a></li><li><a class="childNavLink" href="https://privacy.apache.org/policies/privacy-policy-public.html">隐私条款</a></li></ul></div></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">Language
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="https://kyuubi.apache.org/developer-tools.html">English</a></li></ul></div></li></ul><a class="shareImgContainer" href="https://www.apache.org/">Apache Software Foundation
<span class="shareImg"></span>
<img class="disappear" src="/share.png">
<img class="disappear" src="/activeShare.png"></a></nav><nav id="header_mobile" class="header_mobile"><a href="/"><img class="navbar_logo" src="/kyuubi_logo_hd.png"></a><div class="phoneBtn" id="phoneBtn"><span></span>
<span></span>
<span class="headerClose"></span></div><div class="mobileNavContainer"><ul class="navContainer"><li class="navItem"><a class="navLink" href="zh/releases.html">下载</a></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">文档
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/master/">master (dev-only)</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.11.0/">1.11.0
(latest)</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.10.3/">1.10.3</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.9.4/">1.9.4</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.8.3/">1.8.3</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.7.4/">1.7.4</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.6.1-incubating/">1.6.1-incubating</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.5.2-incubating/">1.5.2-incubating</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.4.1-incubating/">1.4.1-incubating</a></li><li><a class="childNavLink" href="https://kyuubi.readthedocs.io/en/v1.3.1-incubating/">1.3.1-incubating</a></li></ul></div></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">社区
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="https://www.apache.org/foundation/policies/conduct">行为守则</a></li><li><a class="childNavLink" href="/zh/become_committer.html">成为 Committer</a></li><li><a class="childNavLink" href="/zh/become_pmc_member.html">成为 PMC 成员</a></li><li><a class="childNavLink" href="/zh/new_pmc_member_process.html">新晋 PMC 流程</a></li><li><a class="childNavLink" href="/zh/project_history.html">最新消息</a></li><li><a class="childNavLink" href="/zh/mailing_lists.html">加入邮件列表</a></li><li><a class="childNavLink" href="/zh/new_committer_process.html">新晋 Committer 流程</a></li></ul></div></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">发展
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="/zh/issue_tracking.html">问题追踪</a></li><li><a class="childNavLink" href="/zh/pull_request.html">提交PR指南</a></li><li><a class="childNavLink" href="/zh/improvement-proposals.html">改进提案 (KPIP)</a></li><li><a class="childNavLink" href="/zh/developer-tools.html">有用的开发者工具</a></li><li><a class="childNavLink" href="/zh/version_control.html">版本控制</a></li></ul></div></li><li class="navItem"><a class="navLink" href="zh/powered_by.html">用户</a></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">Github
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="https://github.com/apache/kyuubi">kyuubi</a></li><li><a class="childNavLink" href="https://github.com/apache/kyuubi-client">kyuubi-client</a></li><li><a class="childNavLink" href="https://github.com/apache/kyuubi-docker">kyuubi-docker</a></li><li><a class="childNavLink" href="https://github.com/apache/kyuubi-website">kyuubi-website</a></li></ul></div></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">ASF
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="https://www.apache.org/licenses/">License</a></li><li><a class="childNavLink" href="https://www.apache.org/">基金会</a></li><li><a class="childNavLink" href="https://www.apache.org/security/">安全</a></li><li><a class="childNavLink" href="https://www.apache.org/foundation/thanks.html">感谢</a></li><li><a class="childNavLink" href="https://www.apache.org/events/current-event">活动</a></li><li><a class="childNavLink" href="https://www.apache.org/foundation/sponsorship.html">赞助</a></li><li><a class="childNavLink" href="https://privacy.apache.org/policies/privacy-policy-public.html">隐私条款</a></li></ul></div></li><li class="navItem"><a href="javascript:;" class="navLink navLinkWithChild" role="button" aria-haspopup="true" aria-expanded="false">Language
<span class="navAngle"></span></a><div class="childNavContainer"><ul class="childNav"><li><a class="childNavLink" href="https://kyuubi.apache.org/developer-tools.html">English</a></li></ul></div></li></ul><a class="shareImgContainer" href="https://www.apache.org/">Apache Software Foundation
<span class="shareImg"></span>
<img class="disappear" src="/share.png">
<img class="disappear" src="/activeShare.png"></a></div></nav><script>var header_mobile,header,phoneBtn=document.getElementById("phoneBtn"),mask=document.getElementById("nav_mask");phoneBtn.addEventListener("click",function(){var t=mask.style.display!=="none";phoneBtn.className=t?"phoneBtn":"phoneBtn closeBtn",mask.style.display=t?"none":" block"}),mask.addEventListener("click",function(){phoneBtn.className="phoneBtn",mask.style.display="none"}),header_mobile=document.getElementById("header_mobile"),header_mobile.addEventListener("click",function(e){var t,n,s=e.target.className;s==="navLink navLinkWithChild"&&(t=e.target.parentNode,n=t.className!=="navItem",t.className=n?"navItem":"navItem openNavItem")}),header=document.getElementById("header"),window.onscroll=function(){var e=document.documentElement.scrollLeft||document.body.scrollLeft;header.style.left=-e+"px"}</script><div class="container"><h1>有用的开发者工具</h1><h2 id="构建-kyuubi">构建 Kyuubi</h2><h3 id="使用-apache-maven-构建-kyuubi">使用 Apache Maven 构建 Kyuubi</h3><p><strong>Kyuubi</strong> 是基于 <a href="http://maven.apache.org">Apache Maven</a> 构建的，使用命令：</p><pre tabindex="0"><code>./build/mvn clean package -DskipTests
</code></pre><p>这会构建 Kyuubi 项目的所有子模块而无需运行任何单元测试。</p><p>如果要手动测试，可以直接在 Kyuubi 项目的根目录下运行 Kyuubi 启动：</p><pre tabindex="0"><code>bin/kyuubi start
</code></pre><h3 id="单独构建子模块">单独构建子模块</h3><p>例如，构建 Kyuubi Common 模块，可以使用命令:</p><pre tabindex="0"><code>build/mvn clean package -pl :kyuubi-common -DskipTests
</code></pre><h3 id="单独构建多个子模块">单独构建多个子模块</h3><p>例如，使用构建 Kyuubi Common、Kyuubi Ha 模块，可以使用命令:</p><pre tabindex="0"><code>build/mvn clean package -pl :kyuubi-common,:kyuubi-ha -DskipTests
</code></pre><h3 id="跳过一些模块">跳过一些模块</h3><p>例如，构建没有 Kyuubi Codecov 和 Assembly 模块，可以使用命令:</p><pre tabindex="0"><code>build/mvn clean install -pl &#39;!:kyuubi-codecov,!:kyuubi-assembly&#39; -DskipTests
</code></pre><h3 id="针对不同的-apache-spark-版本构建-kyuubi">针对不同的 Apache Spark 版本构建 Kyuubi</h3><p>从 v1.1.0 开始，Kyuubi 可以支持使用不同的 Spark 配置文件构建：</p><table><thead><tr><th>Profile</th><th>Default</th><th>Since</th></tr></thead><tbody><tr><td>-Pspark-3.0</td><td>No</td><td>1.0.0</td></tr><tr><td>-Pspark-3.1</td><td>No</td><td>1.1.0</td></tr><tr><td>-Pspark-3.2</td><td>Yes</td><td>1.4.0</td></tr><tr><td>-Pspark-3.3</td><td>No</td><td>1.6.0</td></tr></tbody></table><h3 id="配置-apache-spark-的镜像">配置 Apache Spark 的镜像</h3><p>我们默认使用 <code>https://archive.apache.org/dist/spark/</code> 下载内置 Spark 发布包，
但是如果发现下载速度很慢或者无法下载，可以使用配置 <code>spark.archive.mirror</code> 配置到合适的镜像地址从而加速下载。 例如：</p><pre tabindex="0"><code>build/mvn clean package -Dspark.archive.mirror=https://mirrors.bfsu.edu.cn/apache/spark/spark-3.2.1
</code></pre><p>专门针对中国大陆的开发者，可以使用名为 <code>mirror-cn</code> 的预定义配置，该配置文件使用 <code>mirrors.bfsu.edu.cn</code> 来加速 Spark 二进制文件的下载。例如，</p><pre tabindex="0"><code>build/mvn clean package -Pmirror-cn
</code></pre><h2 id="构建可运行的发行版">构建可运行的发行版</h2><p>创建一个 Kyuubi 发行版，就像 <a href="https://github.com/apache/kyuubi/releases">Kyuubi Release Page</a>
中展示的一样，在项目根目录中使用 <code>./build/dist</code> 构建。</p><p>有关使用的更多信息，请运行 <code>./build/dist --help</code></p><pre tabindex="0"><code class="language-logtalk" data-lang="logtalk">./build/dist - Tool for making binary distributions of Kyuubi Server

Usage:
+--------------------------------------------------------------------------------------+
| ./build/dist [--name &lt;custom_name&gt;] [--tgz] [--spark-provided] &lt;maven build options&gt; |
+--------------------------------------------------------------------------------------+
name:           -  custom binary name, using project version if undefined
tgz:            -  whether to make a whole bundled package
spark-provided: -  whether to make a package without Spark binary
</code></pre><p>例如：</p><pre tabindex="0"><code>./build/dist --name custom-name --tgz
</code></pre><p>这会为你构建一个 Kyuubi 的发行版的包名为 <code>kyuubi-{version}-bin-custom-name.tar.gz</code>。</p><p>如果你想部署 Kyuubi 地方在已经有了 <code>Spark</code>，换句话说，你不需要内置捆绑下载的 <code>Spark</code>，则可以使用命令：</p><pre tabindex="0"><code>./build/dist --tgz --spark-provided
</code></pre><p>然后你会得到一个没有 Spark 二进制包 Kyuubi 发行版 <code>kyuubi-{version}-bin-without-spark.tar.gz</code>。</p><h2 id="构建-kyuubi-文档">构建 Kyuubi 文档</h2><p>按照以下步骤，学习如何构建 Kyuubi 文档。</p><h3 id="安装和激活-virtualenv">安装和激活 <code>virtualenv</code></h3><p>首先，安装 <code>virtualenv</code>，这是可选的，但还是建议创建一个独立的环境来解决构建文档的依赖问题。</p><pre tabindex="0"><code>pip install virtualenv
</code></pre><p>切换到根目录下的 <code>docs</code>：</p><pre tabindex="0"><code>cd $KTUUBI_HOME/docs
</code></pre><p>创建一个名为<code>kyuubi</code>的虚拟环境，或者你也可以使用别的名字，只是不要和当前目录的文件夹冲突：</p><pre tabindex="0"><code>virtualenv kyuubi
</code></pre><p>激活它，</p><pre tabindex="0"><code> source ./kyuubi/bin/activate
</code></pre><h3 id="安装所有依赖项">安装所有依赖项</h3><p>安装所有的依赖项 <code>requirements.txt</code></p><pre tabindex="0"><code>pip install -r requirements.txt
</code></pre><h3 id="构建文档">构建文档</h3><pre tabindex="0"><code>make html
</code></pre><p>如果构建过程成功，则 HTML 页面位于 <code>_build/html</code>。</p><h3 id="本地查看">本地查看</h3><p>使用你喜欢的浏览器打开它 <code>_build/html/index.html</code>。</p><h2 id="运行测试">运行测试</h2><p><strong>Kyuubi</strong> 可以基于 <a href="http://maven.apache.org">Apache Maven</a> 和 ScalaTest Maven Plugin 进行测试，
请参考 <a href="http://www.scalatest.org/user_guide/using_the_scalatest_maven_plugin">ScalaTest documentation</a>。</p><h3 id="完全运行测试">完全运行测试</h3><p>以下是运行所有测试的命令示例：</p><pre tabindex="0"><code>./build/mvn clean test
</code></pre><h3 id="为模块运行测试">为模块运行测试</h3><pre tabindex="0"><code>./build/mvn clean test -pl :kyuubi-common
</code></pre><h3 id="为单个测试运行测试">为单个测试运行测试</h3><p>在本地开发时，运行一个测试或几个测试而不是全部测试很方便。</p><p>使用 Maven，可以使用 -DwildcardSuites 标志来运行单个 Scala 测试：</p><pre tabindex="0"><code>./build/mvn test -Dtest=none -DwildcardSuites=org.apache.kyuubi.service.FrontendServiceSuite
</code></pre><p>如果你想做一个需要与 kyuubi-spark-sql-engine 模块集成的单个测试，请先构建 kyuubi-spark-sql-engine 模块的包。</p><p>可以利用现成的工具来构建二进制发行版。</p><pre tabindex="0"><code>./build/dist
</code></pre><h2 id="调试-kyuubi">调试 Kyuubi</h2><p>你可以使用 <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/jpda/conninv.html#Plugin">Java Debug Wire Protocol</a> 来调试 Kyuubi，可以使用你最喜欢的 IDE 工具，例如Intellij IDEA</p><h3 id="远程调试">远程调试</h3><p>我们可以在 <code>KYUUBI_JAVA_OPTS</code> 中配置 JDWP 代理进行调试。</p><p>例如，</p><pre tabindex="0"><code>KYUUBI_JAVA_OPTS=-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=5005 \
bin/kyuubi start
</code></pre><p>在 IDE 调试配置中设置相应的参数（主机和端口），例如，</p><div align=center><p><img src="../imgs/idea_debug.png"></p></div><h3 id="调试应用">调试应用</h3><ul><li>Spark Driver</li></ul><pre tabindex="0"><code>spark.driver.extraJavaOptions   -agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=5005
</code></pre><ul><li>Spark Executor</li></ul><pre tabindex="0"><code>spark.executor.extraJavaOptions   -agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=5005
</code></pre><h2 id="开发者工具">开发者工具</h2><h3 id="更新项目版本">更新项目版本</h3><pre tabindex="0"><code>build/mvn versions:set -DgenerateBackupPoms=false
</code></pre><h3 id="更新文档版本">更新文档版本</h3><p>每当项目版本更新时，请同时更新 <code>docs/conf.py</code> 中的文档版本以针对即将发布的版本。</p><p>例如：</p><pre tabindex="0"><code>release = &#39;1.2.0&#39;
</code></pre><h3 id="更新依赖列表">更新依赖列表</h3><p>Kyuubi 使用 <code>dev/dependencyList</code> 文件指示哪些上游依赖项会实际上进入服务器端的类路径。</p><p>对于 PR，用于依赖检查的 linter 将在 GitHub Actions 中自动执行。</p><p>所以你可以先本地运行 <code>build/dependency.sh</code> 来检测潜在的依赖变化。</p><p>如果更改看起来符合预期，请运行 <code>build/dependency.sh --replace</code> 在你的 PR 中去更新 <code>dev/dependencyList</code>。</p></div><footer class="footer"><div class="footerBox"><div class="footerItem"><a class="acevent" data-class="footerPcImg" data-format="wide" data-mode="dark" data-width="310"></a><a class="acevent" data-class="footerMobileImg" data-format="wide" data-mode="dark" data-width="114"></a><p>The Official Global Conference Series of The Apache Software Foundation, connecting open source technology enthusiasts from
around the world to share the latest technology developments and practices.</p></div><div class="footerBox"><div class="footerCopyRight">Copyright © 2021-2026 The Apache Software Foundation, Licensed under the Apache License, Version 2.0. Apache, the Apache Feather logo is trademarks of The Apache Software Foundation.</div></div></div></footer><script src="/js/vendor/jquery-1.12.4.min.js"></script><script src="/js/vendor/bootstrap.min.js"></script><script src="/js/vendor/semantic.min.js"></script><script src="https://www.apachecon.com/event-images/snippet.js"></script><script>$(function(){$("table").addClass("table table-striped")})</script></body></html>